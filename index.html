<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Reemmy | Firebase Auth</title>
  <style>
    body { font-family: Arial; padding: 20px; }
    .hidden { display: none; }
    button { margin: 5px; }
  </style>
</head>
<body>

  <div id="auth-section">
    <h2>Вход / Регистрация</h2>
    <input id="email" type="email" placeholder="Email"><br>
    <input id="password" type="password" placeholder="Пароль"><br>
    <button onclick="register()">Регистрация</button>
    <button onclick="login()">Вход</button>
  </div>

  <div id="main-section" class="hidden">
    <h2>Добро пожаловать, <span id="user-email"></span></h2>
    <button onclick="showProfile()">Профиль</button>
    <button onclick="logout()">Выход</button>
    <div id="profile-section" class="hidden">
      <h3>Это профиль</h3>
      <p>Здесь будут данные пользователя.</p>
    </div>
  </div>

  <!-- Firebase -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getAuth, onAuthStateChanged, signOut, createUserWithEmailAndPassword, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDCAsvKNtfZqN7wlvDMV_sI8Hn-6cYoGr4",
      authDomain: "reemmy-fdnbf276454rfgh-1.firebaseapp.com",
      projectId: "reemmy-fdnbf276454rfgh-1",
      storageBucket: "reemmy-fdnbf276454rfgh-1.appspot.com",
      messagingSenderId: "1013780844206",
      appId: "1:1013780844206:web:7fc8af82eecf80ee04673f",
      measurementId: "G-7EMR3G2TN9"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    const authSection = document.getElementById('auth-section');
    const mainSection = document.getElementById('main-section');
    const userEmailSpan = document.getElementById('user-email');
    const profileSection = document.getElementById('profile-section');

    // Слушаем изменение статуса пользователя
    onAuthStateChanged(auth, (user) => {
      if (user) {
        authSection.classList.add('hidden');
        mainSection.classList.remove('hidden');
        userEmailSpan.textContent = user.email;
      } else {
        authSection.classList.remove('hidden');
        mainSection.classList.add('hidden');
        userEmailSpan.textContent = '';
        profileSection.classList.add('hidden');
      }
    });

    // Регистрация
    window.register = async function () {
      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;
      try {
        await createUserWithEmailAndPassword(auth, email, password);
        alert("Регистрация прошла успешно");
      } catch (e) {
        alert("Ошибка: " + e.message);
      }
    }

    // Вход
    window.login = async function () {
      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;
      try {
        await signInWithEmailAndPassword(auth, email, password);
      } catch (e) {
        alert("Ошибка входа: " + e.message);
      }
    }

    // Выход
    window.logout = async function () {
      await signOut(auth);
    }

    // Показать профиль
    window.showProfile = function () {
      profileSection.classList.toggle('hidden');
    }
  </script>
</body>
</html>
