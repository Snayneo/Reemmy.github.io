<!-- ДОПИШЕМ код прямо в твой index.html -->
<script type="module">
  import { auth, db, registerUser, loginUser, getUserData, updateUserSocial } from './firebase.js';

  const emailInput = document.getElementById('email');
  const passwordInput = document.getElementById('password');
  const submitBtn = document.getElementById('submitBtn');
  const switchForm = document.getElementById('switchForm');
  const formTitle = document.getElementById('form-title');

  const authSection = document.getElementById('auth-section');
  const profileSection = document.getElementById('profile-section');

  const userEmail = document.getElementById('userEmail');
  const userMoney = document.getElementById('userMoney');
  const userSocial = document.getElementById('userSocial');
  const socialInput = document.getElementById('socialInput');

  let isLogin = true;

  switchForm.onclick = () => {
    isLogin = !isLogin;
    formTitle.innerText = isLogin ? 'Вход' : 'Регистрация';
    submitBtn.innerText = isLogin ? 'Войти' : 'Зарегистрироваться';
    switchForm.innerText = isLogin ? 'Нет аккаунта? Зарегистрироваться' : 'Уже есть аккаунт? Войти';
  };

  submitBtn.onclick = async () => {
    const email = emailInput.value.trim();
    const password = passwordInput.value;

    if (!email || !password) return alert("Введите email и пароль");

    try {
      if (isLogin) {
        await loginUser(email, password);
      } else {
        await registerUser(email, password);
      }
    } catch (err) {
      alert("Ошибка: " + err.message);
    }
  };

  onAuthStateChanged(auth, async (user) => {
    if (user) {
      authSection.classList.add('hidden');
      profileSection.classList.remove('hidden');
      const data = await getUserData(user.uid);

      userEmail.textContent = data.email;
      userMoney.textContent = (data.money || 0) + "₸";
      userSocial.textContent = data.social || 'не привязано';
    } else {
      authSection.classList.remove('hidden');
      profileSection.classList.add('hidden');
    }
  });

  window.saveSocial = async () => {
    const social = socialInput.value.trim();
    if (!social) return alert("Введите соцсеть");

    const user = auth.currentUser;
    await updateUserSocial(user.uid, social);
    userSocial.textContent = social;
    alert("Сохранено!");
  };

  window.logout = async () => {
    await signOut(auth);
  };
</script>
